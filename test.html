<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>KuyShare - V2Ray</title>
<link rel="icon" href="https://raw.githubusercontent.com/AFRcloud/BG/main/icons8-film-noir-80.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
    --primary: #6366f1;
    --primary-dark: #4f46e5;
    --secondary: #10b981;
    --dark: #0f172a;
    --dark-light: #1e293b;
    --light: #f8fafc;
    --gray: #64748b;
    --gray-light: #94a3b8;
}

* {
    font-family: 'Inter', sans-serif;
}

body {
    background-color: var(--dark);
    color: var(--light);
    min-height: 100vh;
}

.card {
    background: rgba(30, 41, 59, 0.6);
    border: 1px solid rgba(99, 102, 241, 0.15);
    border-radius: 12px;
    transition: all 0.2s ease;
}

.input {
    background: rgba(15, 23, 42, 0.5);
    border: 1px solid rgba(99, 102, 241, 0.15);
    color: var(--light);
    border-radius: 8px;
    transition: all 0.2s ease;
}

.input:focus {
    border-color: var(--primary);
    outline: none;
    box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.1);
}

.input[readonly] {
    background: rgba(51, 65, 85, 0.3);
}

.select {
    background: rgba(15, 23, 42, 0.5);
    border: 1px solid rgba(99, 102, 241, 0.15);
    color: var(--light);
    border-radius: 8px;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2394a3b8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 1rem;
    padding-right: 2.5rem;
}

.select:focus {
    border-color: var(--primary);
    outline: none;
    box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.1);
}

.btn-primary {
    background: var(--primary);
    color: white;
    border-radius: 8px;
    font-weight: 500;
    transition: all 0.2s ease;
}

.btn-primary:hover {
    background: var(--primary-dark);
}

.btn-secondary {
    background: rgba(51, 65, 85, 0.5);
    border: 1px solid rgba(99, 102, 241, 0.15);
    color: var(--light);
    border-radius: 8px;
    font-weight: 500;
    transition: all 0.2s ease;
}

.btn-secondary:hover {
    background: rgba(71, 85, 105, 0.6);
}

.tab {
    position: relative;
    transition: all 0.2s ease;
    font-weight: 500;
    color: var(--gray-light);
}

.tab.active {
    color: var(--primary);
}

.tab.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    width: 100%;
    height: 2px;
    background: var(--primary);
    border-radius: 2px;
}

.divider {
    height: 1px;
    background: rgba(99, 102, 241, 0.2);
}

.code {
    background: rgba(15, 23, 42, 0.5);
    border: 1px solid rgba(99, 102, 241, 0.15);
    font-family: 'Courier New', monospace;
    border-radius: 8px;
}

.loading-spinner {
    border: 3px solid rgba(51, 65, 85, 0.3);
    border-top: 3px solid var(--primary);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
}

.loading-spinner-sm {
    border: 2px solid rgba(51, 65, 85, 0.3);
    border-top: 2px solid var(--primary);
    border-radius: 50%;
    width: 24px;
    height: 24px;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.proxy-card {
    background: rgba(30, 41, 59, 0.4);
    border-radius: 10px;
    padding: 0.75rem;
    margin-bottom: 0.75rem;
    border: 1px solid rgba(99, 102, 241, 0.1);
    transition: all 0.2s ease;
}

.proxy-card:hover {
    background: rgba(51, 65, 85, 0.4);
    border-color: rgba(99, 102, 241, 0.2);
    transform: translateY(-2px);
}

.pagination-btn {
    min-width: 36px;
    height: 36px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    font-size: 0.875rem;
    transition: all 0.2s ease;
    background: rgba(51, 65, 85, 0.3);
    border: 1px solid rgba(99, 102, 241, 0.1);
}

.pagination-btn.active {
    background: var(--primary);
    color: white;
    border: none;
}

.pagination-btn:not(.active):not(.disabled):hover {
    background: rgba(71, 85, 105, 0.4);
}

.pagination-btn.disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.qrcode-container {
    background-color: white;
    padding: 12px;
    border-radius: 10px;
    display: inline-block;
    margin: 0 auto;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.qrcode-container img, 
.qrcode-container canvas {
    display: block;
    max-width: 100%;
    height: auto;
}

.wildcard-container {
    display: none;
    margin-top: 0.5rem;
    padding: 0.5rem;
    border-radius: 0.5rem;
    background: rgba(15, 23, 42, 0.3);
}

.wildcard-container.show {
    display: block;
}

.checkbox-container {
    display: flex;
    align-items: center;
}

.checkbox-container input[type="checkbox"] {
    width: 1rem;
    height: 1rem;
    margin-right: 0.5rem;
    accent-color: var(--primary);
}

.checkbox-container label {
    font-size: 0.875rem;
    color: var(--gray-light);
}

.status-active {
    background: rgba(16, 185, 129, 0.1);
    border: 1px solid rgba(16, 185, 129, 0.2);
}

.status-dead {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.2);
}

.status-unknown {
    background: rgba(245, 158, 11, 0.1);
    border: 1px solid rgba(245, 158, 11, 0.2);
}

@media (max-width: 640px) {
    .proxy-card .flex {
        flex-direction: row !important;
        justify-content: space-between !important;
        align-items: center !important;
    }
    
    .proxy-card .flex > div:first-child {
        flex: 1;
        min-width: 0;
        margin-bottom: 0 !important;
        padding-right: 8px;
    }
    
    .proxy-card .font-medium {
        max-width: 150px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
    }
    
    .proxy-card .text-xs {
        font-size: 0.65rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    .create-account-btn {
        padding: 0.375rem 0.5rem !important;
        font-size: 0.65rem !important;
        min-width: 60px !important;
        width: auto !important;
    }
}

.header {
    border-radius: 12px 12px 0 0;
    padding: 1.5rem 0;
    background: linear-gradient(to right, rgba(79, 70, 229, 0.05) 0%, rgba(16, 185, 129, 0.05) 100%);
}

.footer {
    background: rgba(15, 23, 42, 0.2);
    border-radius: 12px;
    border: 1px solid rgba(99, 102, 241, 0.1);
}

.donation-btn {
    background: var(--primary);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: all 0.2s ease;
}

.donation-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
}

.modal-backdrop {
    background-color: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(4px);
}

.modal-content {
    background: linear-gradient(to bottom, #1e293b, #0f172a);
    border: 1px solid rgba(99, 102, 241, 0.2);
    border-radius: 12px;
}
</style>
</head>
<body class="font-sans">
<div class="container mx-auto px-2 sm:px-4 py-4 sm:py-6 max-w-xl">
    <div class="card overflow-hidden">
        <div class="header">
            <div class="flex items-center justify-center">
                <div class="mr-3">
                    <i class="fas fa-network-wired text-4xl text-indigo-400"></i>
                </div>
                <h1 class="text-3xl font-bold text-center bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-emerald-400">KuyShare - V2Ray</h1>
            </div>
        </div>
        
        <div class="p-6">
            <div id="proxy-list-section">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-5">
                    <div class="flex items-center mb-3 sm:mb-0">
                        <i class="fas fa-server mr-2 text-indigo-400"></i>
                        <h2 class="text-xl font-semibold">Proxy List</h2>
                    </div>
                    <div class="flex flex-col sm:flex-row w-full sm:w-auto space-y-2 sm:space-y-0 sm:space-x-3">
                        <button id="refresh-btn" class="btn-primary py-2 px-4 rounded-lg flex items-center justify-center text-sm">
                            <i class="fas fa-sync-alt mr-2"></i>Refresh
                        </button>
                        <button id="custom-url-btn" class="btn-secondary py-2 px-4 rounded-lg flex items-center justify-center text-sm">
                            <i class="fas fa-link mr-2"></i>URL
                        </button>
                    </div>
                </div>
                
                <div id="custom-url-input" class="mb-5 hidden">
                    <div class="flex">
                        <input type="text" id="proxy-url" class="flex-1 px-4 py-2.5 input rounded-l-lg text-sm" 
                            placeholder="Enter custom proxy list URL" 
                            value="https://proxy.kuyshare.eu.org/active.txt">
                        <button id="load-custom-url" class="btn-primary px-4 py-2.5 rounded-r-lg">
                            Load
                        </button>
                    </div>
                </div>
                
                <div id="loading-indicator" class="text-center py-10 hidden">
                    <div class="loading-spinner mx-auto mb-4"></div>
                    <p class="text-indigo-300 text-sm">Loading proxy list...</p>
                </div>
                
                <div class="mb-4">
                    <div class="relative">
                        <input type="text" id="search-input" class="w-full pl-10 pr-4 py-2.5 input rounded-lg text-sm" placeholder="Search by provider or country...">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                    </div>
                </div>
                
                <div id="proxy-list-container" class="mt-4">
                    </div>
                
                <div id="pagination-container" class="flex justify-center items-center mt-6 space-x-2">
                    </div>

                <div id="proxy-count-info" class="text-center mt-3 text-sm text-gray-400">
                    </div>
                
                <div id="no-proxies-message" class="text-center py-10 hidden">
                    <i class="fas fa-exclamation-circle text-rose-400 text-4xl mb-3"></i>
                    <p class="text-gray-300 text-sm">No proxies found. Please refresh or try a different URL.</p>
                </div>
            </div>
            
            <div id="account-creation-section" class="mt-6 hidden">
                <div class="pt-4">
                    <div class="divider mb-6"></div>
                    <div class="flex justify-between items-center mb-5">
                        <div class="flex items-center">
                            <i class="fas fa-user-plus mr-2 text-indigo-400"></i>
                            <h2 class="text-xl font-semibold">Create Account</h2>
                        </div>
                        <button id="back-to-list" class="flex items-center text-indigo-400 hover:text-indigo-300 transition-colors text-sm">
                            <i class="fas fa-arrow-left mr-2"></i> Back to List
                        </button>
                    </div>
                    
                    <div class="card p-5 mb-6">
                        <h3 class="text-base font-medium text-indigo-400 mb-4 flex items-center">
                            <i class="fas fa-server mr-2"></i>
                            Selected Proxy
                        </h3>
                        
                        <div class="grid grid-cols-2 gap-3 mb-4">
                            <div class="flex items-center space-x-2 bg-slate-800/30 p-3 rounded-lg border border-slate-700/20">
                                <i class="fas fa-building text-indigo-400/70 w-5 text-center"></i>
                                <div>
                                    <div class="text-xs text-gray-400">Provider</div>
                                    <div id="selected-provider" class="text-sm font-medium text-white">-</div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2 bg-slate-800/30 p-3 rounded-lg border border-slate-700/20">
                                <i class="fas fa-globe-americas text-indigo-400/70 w-5 text-center"></i>
                                <div>
                                    <div class="text-xs text-gray-400">Country</div>
                                    <div id="selected-country" class="text-sm font-medium text-white">-</div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2 bg-slate-800/30 p-3 rounded-lg border border-slate-700/20">
                                <i class="fas fa-network-wired text-indigo-400/70 w-5 text-center"></i>
                                <div>
                                    <div class="text-xs text-gray-400">IP</div>
                                    <div id="selected-ip" class="text-sm font-medium text-white">-</div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2 bg-slate-800/30 p-3 rounded-lg border border-slate-700/20">
                                <i class="fas fa-plug text-indigo-400/70 w-5 text-center"></i>
                                <div>
                                    <div class="text-xs text-gray-400">Port</div>
                                    <div id="selected-port" class="text-sm font-medium text-white">-</div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="proxy-status-container" class="hidden">
                            <div id="proxy-status-active" class="hidden rounded-lg p-3 status-active">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-emerald-500/10 flex items-center justify-center mr-3 border border-emerald-500/20">
                                        <i class="fas fa-check text-emerald-400"></i>
                                    </div>
                                    <div>
                                        <div class="text-sm font-medium text-emerald-400">ACTIVE</div>
                                        <div class="text-xs text-gray-400">Latency: <span id="proxy-latency" class="text-amber-400">0ms</span></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="proxy-status-dead" class="hidden rounded-lg p-3 status-dead">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-rose-500/10 flex items-center justify-center mr-3 border border-rose-500/20">
                                        <i class="fas fa-times text-rose-500"></i>
                                    </div>
                                    <div>
                                        <div class="text-sm font-medium text-rose-500">DEAD</div>
                                        <div class="text-xs text-gray-400">This proxy may not be working</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="proxy-status-unknown" class="hidden rounded-lg p-3 status-unknown">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-amber-500/10 flex items-center justify-center mr-3 border border-amber-500/20">
                                        <i class="fas fa-question text-amber-400"></i>
                                    </div>
                                    <div>
                                        <div class="text-sm font-medium text-amber-400">UNKNOWN</div>
                                        <div class="text-xs text-gray-400">Could not check proxy status</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="proxy-status-loading" class="rounded-lg p-3 bg-indigo-900/10 border border-indigo-500/20">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-indigo-500/10 flex items-center justify-center mr-3 border border-indigo-500/20">
                                        <div class="loading-spinner-sm"></div>
                                    </div>
                                    <div>
                                        <div class="text-sm font-medium text-indigo-400">CHECKING</div>
                                        <div class="text-xs text-gray-400">Verifying proxy status...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex border-b border-gray-700 mb-6 overflow-x-auto space-x-1 sm:space-x-0">
                        <button class="tab active py-3 px-4 font-medium text-sm focus:outline-none" data-target="vless-form">
                            <i class="fas fa-bolt mr-2"></i>VLESS
                        </button>
                        <button class="tab py-3 px-4 font-medium text-sm focus:outline-none" data-target="trojan-form">
                            <i class="fas fa-user-secret mr-2"></i>Trojan
                        </button>
                        <button class="tab py-3 px-4 font-medium text-sm focus:outline-none" data-target="ss-form">
                            <i class="fas fa-mask mr-2"></i>SS
                        </button>
                    </div>
                    
                    
                    <div id="vless-form" class="protocol-form">
                        <form id="vless-account-form" class="space-y-5">
                            <div>
                                <label for="vless-name" class="block text-sm font-medium text-gray-300 mb-2">Account Name</label>
                                <input type="text" id="vless-name" name="name" class="w-full px-4 py-2.5 input rounded-lg text-sm" readonly>
                            </div>
                            
                            <div>
                                <label for="vless-uuid" class="block text-sm font-medium text-gray-300 mb-2">UUID</label>
                                <div class="flex">
                                    <input type="text" id="vless-uuid" name="uuid" class="flex-1 px-4 py-2.5 input rounded-l-lg text-sm" value="00000000-0000-0000-0000-000000000000" required>
                                    <button type="button" onclick="generateUUID('vless-uuid')" class="btn-secondary px-4 py-2.5 rounded-r-lg hover:bg-slate-700">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div>
                                <label for="vless-path" class="block text-sm font-medium text-gray-300 mb-2">Path</label>
                                <input type="text" id="vless-path" name="path" class="w-full px-4 py-2.5 input rounded-lg text-sm" readonly>
                            </div>
                            
                            <div>
                                <label for="vless-security" class="block text-sm font-medium text-gray-300 mb-2">TLS</label>
                                <select id="vless-security" name="security" class="w-full px-4 py-2.5 select rounded-lg text-sm">
                                    <option value="tls">TLS</option>
                                    <option value="none">None</option>
                                </select>
                                <input type="hidden" id="vless-encryption" name="encryption" value="none">
                            </div>
                            
                            <div>
                                <label for="vless-server-domain" class="block text-sm font-medium text-gray-300 mb-2">Server Domain</label>
                                <select id="vless-server-domain" name="server-domain" class="w-full px-4 py-2.5 select rounded-lg text-sm">
                                    </select>
                            </div>
                            
                            <div>
                                <label for="vless-bug" class="block text-sm font-medium text-gray-300 mb-2">Custom Bug <span class="text-xs text-gray-500">(opsional)</span></label>
                                <input type="text" id="vless-bug" name="bug" class="w-full px-4 py-2.5 input rounded-lg text-sm" placeholder="e.g. bug.com">
                                <div id="vless-wildcard-container" class="wildcard-container">
                                    <div class="checkbox-container">
                                        <input type="checkbox" id="vless-wildcard" name="wildcard">
                                        <label for="vless-wildcard">Gunakan Wildcard (bug.domain.com)</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="pt-2">
                                <button type="submit" class="w-full btn-primary py-3 px-4 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-plus-circle mr-2"></i> Create VLESS Account
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="trojan-form" class="protocol-form hidden">
                        <form id="trojan-account-form" class="space-y-5">
                            <div>
                                <label for="trojan-name" class="block text-sm font-medium text-gray-300 mb-2">Account Name</label>
                                <input type="text" id="trojan-name" name="name" class="w-full px-4 py-2.5 input rounded-lg text-sm" readonly>
                            </div>
                            
                            <div>
                                <label for="trojan-password" class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                                <div class="flex">
                                    <input type="text" id="trojan-password" name="password" class="flex-1 px-4 py-2.5 input rounded-l-lg text-sm" value="00000000-0000-0000-0000-000000000000" required>
                                    <button type="button" onclick="generatePassword('trojan-password')" class="btn-secondary px-4 py-2.5 rounded-r-lg hover:bg-slate-700">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div>
                                <label for="trojan-path" class="block text-sm font-medium text-gray-300 mb-2">Path</label>
                                <input type="text" id="trojan-path" name="path" class="w-full px-4 py-2.5 input rounded-lg text-sm" readonly>
                            </div>
                            
                            <div>
                                <label for="trojan-security" class="block text-sm font-medium text-gray-300 mb-2">TLS</label>
                                <select id="trojan-security" name="security" class="w-full px-4 py-2.5 select rounded-lg text-sm">
                                    <option value="tls">TLS</option>
                                    <option value="none">None</option>
                                </select>
                                <input type="hidden" id="trojan-sni" name="sni" value="v.vles.tech">
                            </div>
                            
                            <div>
                                <label for="trojan-server-domain" class="block text-sm font-medium text-gray-300 mb-2">Server Domain</label>
                                <select id="trojan-server-domain" name="server-domain" class="w-full px-4 py-2.5 select rounded-lg text-sm">
                                    </select>
                            </div>
                            
                            <div>
                                <label for="trojan-bug" class="block text-sm font-medium text-gray-300 mb-2">Custom Bug <span class="text-xs text-gray-500">(opsional)</span></label>
                                <input type="text" id="trojan-bug" name="bug" class="w-full px-4 py-2.5 input rounded-lg text-sm" placeholder="e.g. bug.com">
                                <div id="trojan-wildcard-container" class="wildcard-container">
                                    <div class="checkbox-container">
                                        <input type="checkbox" id="trojan-wildcard" name="wildcard">
                                        <label for="trojan-wildcard">Gunakan Wildcard (bug.domain.com)</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="pt-2">
                                <button type="submit" class="w-full btn-primary py-3 px-4 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-plus-circle mr-2"></i> Create Trojan Account
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="ss-form" class="protocol-form hidden">
                        <form id="ss-account-form" class="space-y-5">
                            <div>
                                <label for="ss-name" class="block text-sm font-medium text-gray-300 mb-2">Account Name</label>
                                <input type="text" id="ss-name" name="name" class="w-full px-4 py-2.5 input rounded-lg text-sm" readonly>
                            </div>
                            
                            <div>
                                <label for="ss-password" class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                                <div class="flex">
                                    <input type="text" id="ss-password" name="password" class="flex-1 px-4 py-2.5 input rounded-l-lg text-sm" value="00000000-0000-0000-0000-000000000000" required>
                                    <button type="button" onclick="generatePassword('ss-password')" class="btn-secondary px-4 py-2.5 rounded-r-lg hover:bg-slate-700">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div>
                                <label for="ss-path" class="block text-sm font-medium text-gray-300 mb-2">Path</label>
                                <input type="text" id="ss-path" name="path" class="w-full px-4 py-2.5 input rounded-lg text-sm" readonly>
                            </div>
                            
                            <div>
                                <label for="ss-security" class="block text-sm font-medium text-gray-300 mb-2">TLS</label>
                                <select id="ss-security" name="security" class="w-full px-4 py-2.5 select rounded-lg text-sm">
                                    <option value="tls">TLS</option>
                                    <option value="none">None</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="ss-server-domain" class="block text-sm font-medium text-gray-300 mb-2">Server Domain</label>
                                <select id="ss-server-domain" name="server-domain" class="w-full px-4 py-2.5 select rounded-lg text-sm">
                                    </select>
                            </div>
                            
                            <div>
                                <label for="ss-bug" class="block text-sm font-medium text-gray-300 mb-2">Custom Bug <span class="text-xs text-gray-500">(opsional)</span></label>
                                <input type="text" id="ss-bug" name="bug" class="w-full px-4 py-2.5 input rounded-lg text-sm" placeholder="e.g. bug.com">
                                <div id="ss-wildcard-container" class="wildcard-container">
                                    <div class="checkbox-container">
                                        <input type="checkbox" id="ss-wildcard" name="wildcard">
                                        <label for="ss-wildcard">Gunakan Wildcard (bug.domain.com)</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="pt-2">
                                <button type="submit" class="w-full btn-primary py-3 px-4 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-plus-circle mr-2"></i> Create Shadowsocks Account
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <div id="result-section" class="mt-6 hidden">
                <div class="pt-4">
                    <div class="divider mb-6"></div>
                    <div class="flex justify-between items-center mb-5">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle mr-2 text-emerald-400"></i>
                            <h2 class="text-xl font-semibold">Account Created</h2>
                        </div>
                        <button id="back-to-form" class="flex items-center text-indigo-400 hover:text-indigo-300 transition-colors text-sm">
                            <i class="fas fa-arrow-left mr-2"></i> Back
                        </button>
                    </div>
                    <div class="card p-5 mb-5">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="text-base font-medium text-indigo-400">Connection URL</h3>
                            <button id="copy-url" class="flex items-center text-indigo-400 hover:text-indigo-300 text-xs transition-colors">
                                <i class="far fa-copy mr-1"></i> Copy
                            </button>
                        </div>
                        <div id="connection-url" class="text-xs code p-4 rounded-lg break-all font-mono"></div>
                    </div>
                    <div class="card p-5">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="text-base font-medium text-indigo-400">QR Code</h3>
                            <button id="download-qr" class="flex items-center text-indigo-400 hover:text-indigo-300 text-xs transition-colors">
                                <i class="fas fa-download mr-1"></i> Download
                            </button>
                        </div>
                        <div class="flex justify-center py-4">
                            <div id="qrcode" class="qrcode-container"></div>
                        </div>
                    </div>
                    <div class="mt-6 flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3">
                        <button id="create-new" class="flex-1 btn-primary py-3 px-4 rounded-lg flex items-center justify-center text-sm">
                            <i class="fas fa-plus-circle mr-2"></i> Create Another
                        </button>
                        <button id="back-to-list-from-result" class="flex-1 btn-secondary py-3 px-4 rounded-lg flex items-center justify-center text-sm">
                            <i class="fas fa-list mr-2"></i> Back to List
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="mt-8 pb-6">
        <div class="divider mb-6"></div>
        <div class="footer p-6">
            <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-indigo-500/10 flex items-center justify-center mr-3 border border-indigo-500/20">
                        <i class="fas fa-network-wired text-lg text-indigo-400"></i>
                    </div>
                    <span class="text-lg font-semibold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-emerald-400">KuyShare- V2Ray</span>
                </div>
                <div class="flex gap-4">
                    <a href="://facebook.com/rilisanterbaru" class="w-8 h-8 rounded-full bg-slate-700/50 flex items-center justify-center text-gray-400 hover:text-indigo-400 hover:bg-slate-700 transition-all">
                        <i class="fab fa-facebook"></i>
                    </a>
                    <a href="https://t.me/kuyshare" class="w-8 h-8 rounded-full bg-slate-700/50 flex items-center justify-center text-gray-400 hover:text-indigo-400 hover:bg-slate-700 transition-all">
                        <i class="fab fa-telegram"></i>
                    </a>
                </div>
            </div>
            <div class="h-px bg-gradient-to-r from-transparent via-slate-600/20 to-transparent my-5"></div>
            <div class="text-center text-gray-500 text-xs">
                <p>© 2025 KuyShare - V2Ray</p>
                <p class="mt-1 flex items-center justify-center">
                    Dibuat dengan <i class="fas fa-heart text-rose-500 mx-1"></i> untuk privasi online Anda
                </p>
            </div>
        </div>
    </footer>
</div>

<div id="donation-button" class="fixed bottom-6 right-6 z-[1000]">
    <button class="w-12 h-12 rounded-full donation-btn flex items-center justify-center shadow-lg">
        <i class="fas fa-hand-holding-heart text-white text-lg"></i>
    </button>
</div>

<div id="donation-modal" class="fixed inset-0 z-[1001] flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity duration-300">
    <div class="absolute inset-0 modal-backdrop" id="donation-backdrop"></div>
    <div class="relative modal-content p-6 max-w-md w-full transform scale-95 transition-all duration-300" id="donation-content">
        <button id="close-donation" class="absolute top-2 right-2 w-8 h-8 flex items-center justify-center rounded-full bg-slate-800 hover:bg-slate-700 text-gray-400 hover:text-white transition-colors">
            <i class="fas fa-times"></i>
        </button>
        <h3 class="text-xl font-bold mb-2 text-center bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-purple-400">Suppor:</h3>
        <p class="text-gray-400 text-sm mb-4 text-center">Your donation helps keep our services running</p>
        <div class="p-3 bg-white rounded-xl mb-4">
            <img src="https://telegra.ph/file/1e30ae8616d1fd0bc3c48.png" alt="Donation QR Code" class="w-full h-auto max-w-xs mx-auto">
        </div>
        <p class="text-gray-400 text-xs text-center">Scan this QR code with your payment app to donate</p>
    </div>
</div>

<script>
// Global variables
let proxyList = [];
let filteredProxyList = [];
let selectedProxy = null;
const defaultProxyUrl = 'https://proxy.kuyshare.eu.org/active.txt';
const serverDomains = ['v.vles.tech'];
let selectedServerDomain = serverDomains[0]; // Default to first domain
const defaultUUID = '00000000-0000-0000-0000-000000000000';
const itemsPerPage = 10;
let currentPage = 1;

// DOM elements
const proxyListSection = document.getElementById('proxy-list-section');
const accountCreationSection = document.getElementById('account-creation-section');
const resultSection = document.getElementById('result-section');
const loadingIndicator = document.getElementById('loading-indicator');
const proxyListContainer = document.getElementById('proxy-list-container');
const noProxiesMessage = document.getElementById('no-proxies-message');
const customUrlInput = document.getElementById('custom-url-input');
const proxyUrlInput = document.getElementById('proxy-url');
const paginationContainer = document.getElementById('pagination-container');
const proxyCountInfo = document.getElementById('proxy-count-info');
const searchInput = document.getElementById('search-input');

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    // Display fallback proxy list immediately to ensure something is visible
    displayFallbackProxyList();

    // Then try to load the actual proxy list
    loadProxyList(defaultProxyUrl);

    // Event listeners
    document.getElementById('refresh-btn').addEventListener('click', function() {
        loadProxyList(defaultProxyUrl);
    });

    document.getElementById('custom-url-btn').addEventListener('click', function() {
        customUrlInput.classList.toggle('hidden');
    });

    document.getElementById('load-custom-url').addEventListener('click', function() {
        const url = proxyUrlInput.value.trim();
        if (url) {
            loadProxyList(url);
        }
    });

    document.getElementById('back-to-list').addEventListener('click', function() {
        showProxyListSection();
    });

    document.getElementById('back-to-form').addEventListener('click', function() {
        showAccountCreationSection();
    });

    document.getElementById('create-new').addEventListener('click', function() {
        showAccountCreationSection();
    });

    document.getElementById('back-to-list-from-result').addEventListener('click', function() {
        showProxyListSection();
    });

    // Handle form submissions
    document.getElementById('vless-account-form').addEventListener('submit', function(event) {
        event.preventDefault();
        createAccount('vless');
    });
    
    document.getElementById('trojan-account-form').addEventListener('submit', function(event) {
        event.preventDefault();
        createAccount('trojan');
    });
    
    document.getElementById('ss-account-form').addEventListener('submit', function(event) {
        event.preventDefault();
        createAccount('ss');
    });

    // Tab switching logic
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', function() {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.protocol-form').forEach(f => f.classList.add('hidden'));
            
            this.classList.add('active');
            const targetId = this.getAttribute('data-target');
            document.getElementById(targetId).classList.remove('hidden');
        });
    });

    // Search functionality
    searchInput.addEventListener('input', function() {
        const query = searchInput.value.toLowerCase().trim();
        filterProxies(query);
        displayProxies(filteredProxyList, 1); // Display filtered list starting from page 1
    });

    // QR Code and Copy button event listeners
    document.getElementById('copy-url').addEventListener('click', copyToClipboard);
    document.getElementById('download-qr').addEventListener('click', downloadQrCode);
    
    // Donation button and modal
    const donationButton = document.getElementById('donation-button');
    const donationModal = document.getElementById('donation-modal');
    const donationBackdrop = document.getElementById('donation-backdrop');
    const closeDonation = document.getElementById('close-donation');
    
    donationButton.addEventListener('click', () => {
        donationModal.classList.remove('opacity-0', 'pointer-events-none');
        donationModal.classList.add('opacity-100');
    });

    donationBackdrop.addEventListener('click', () => {
        donationModal.classList.add('opacity-0', 'pointer-events-none');
    });

    closeDonation.addEventListener('click', () => {
        donationModal.classList.add('opacity-0', 'pointer-events-none');
    });
});

// Function to generate the HTML for a proxy card
function createProxyCard(proxy) {
    const card = document.createElement('div');
    card.classList.add('proxy-card', 'cursor-pointer');
    card.setAttribute('data-protocol', proxy.protocol);
    card.setAttribute('data-provider', proxy.provider);
    card.setAttribute('data-country', proxy.country);
    card.setAttribute('data-ip', proxy.ip);
    card.setAttribute('data-port', proxy.port);
    card.setAttribute('data-path', proxy.path);
    card.setAttribute('data-bug', proxy.bug);
    card.setAttribute('data-domain', proxy.domain);
    card.setAttribute('data-security', proxy.security);

    card.innerHTML = `
        <div class="flex flex-row sm:flex-row justify-between items-start sm:items-center">
            <div class="flex-1 min-w-0 mb-2 sm:mb-0">
                <div class="font-medium text-white break-words">${proxy.provider}</div>
                <div class="text-xs text-gray-400 mt-1 flex items-center">
                    <i class="fas fa-globe-americas mr-1"></i> ${proxy.country}
                    <i class="fas fa-link ml-4 mr-1"></i> ${proxy.domain || proxy.ip}
                </div>
            </div>
            <div class="flex space-x-2">
                <span class="text-xs font-semibold px-2 py-1 rounded-full bg-indigo-500/20 text-indigo-300">${proxy.protocol.toUpperCase()}</span>
                <span class="text-xs font-semibold px-2 py-1 rounded-full bg-emerald-500/20 text-emerald-300">ACTIVE</span>
            </div>
        </div>
    `;

    card.addEventListener('click', () => selectProxy(proxy));
    return card;
}

// Function to process the raw proxy data
function processProxyData(text) {
    const lines = text.split('\n');
    proxyList = [];
    lines.forEach(line => {
        if (line.trim() !== '') {
            try {
                // Decode base64
                const decoded = atob(line.trim().slice(6));
                const proxyData = JSON.parse(decoded);
                
                let protocol, ip, port, path, bug, domain, security;

                // Determine protocol from data
                if (line.startsWith('vless://')) {
                    protocol = 'vless';
                } else if (line.startsWith('trojan://')) {
                    protocol = 'trojan';
                } else if (line.startsWith('ss://')) {
                    protocol = 'ss';
                }

                if (protocol) {
                     // Extract data
                    const url = new URL(line);
                    const params = new URLSearchParams(url.hash.substring(1));
                    
                    ip = url.hostname;
                    port = url.port;
                    path = params.get('path');
                    security = params.get('security');
                    
                    // Decode Bug and Domain
                    const decodedBug = params.get('bug');
                    const decodedDomain = params.get('domain');

                    bug = decodedBug ? decodeURIComponent(decodedBug) : 'N/A';
                    domain = decodedDomain ? decodeURIComponent(decodedDomain) : ip;

                    // Extract provider and country from snippet
                    const snippet = params.get('sni');
                    const [provider, country] = snippet ? snippet.split('-') : ['Unknown', 'Unknown'];
                    
                    proxyList.push({
                        protocol,
                        provider: provider.trim() || 'Unknown',
                        country: country.trim() || 'Unknown',
                        ip,
                        port,
                        path,
                        security,
                        bug,
                        domain
                    });
                }
            } catch (error) {
                console.error("Error processing proxy line:", line, error);
            }
        }
    });
    
    // Sort proxies by protocol: VLESS, Trojan, SS
    proxyList.sort((a, b) => {
        const protocolOrder = { 'vless': 1, 'trojan': 2, 'ss': 3 };
        return protocolOrder[a.protocol] - protocolOrder[b.protocol];
    });

    filteredProxyList = [...proxyList];
    displayProxies(filteredProxyList, 1);
}

// Function to display proxy cards with pagination
function displayProxies(proxies, page) {
    proxyListContainer.innerHTML = '';
    paginationContainer.innerHTML = '';

    if (proxies.length === 0) {
        noProxiesMessage.classList.remove('hidden');
        proxyCountInfo.textContent = '0 proxies found.';
        return;
    }
    
    noProxiesMessage.classList.add('hidden');
    
    const start = (page - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const paginatedItems = proxies.slice(start, end);
    
    paginatedItems.forEach(proxy => {
        proxyListContainer.appendChild(createProxyCard(proxy));
    });

    // Pagination controls
    const totalPages = Math.ceil(proxies.length / itemsPerPage);
    currentPage = page;

    // Previous button
    const prevBtn = document.createElement('button');
    prevBtn.classList.add('pagination-btn', 'px-3');
    prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
    if (currentPage === 1) prevBtn.classList.add('disabled');
    prevBtn.addEventListener('click', () => {
        if (currentPage > 1) {
            displayProxies(proxies, currentPage - 1);
        }
    });
    paginationContainer.appendChild(prevBtn);

    // Page buttons
    for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.classList.add('pagination-btn', 'w-9');
        pageBtn.textContent = i;
        if (i === currentPage) pageBtn.classList.add('active');
        pageBtn.addEventListener('click', () => {
            displayProxies(proxies, i);
        });
        paginationContainer.appendChild(pageBtn);
    }

    // Next button
    const nextBtn = document.createElement('button');
    nextBtn.classList.add('pagination-btn', 'px-3');
    nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
    if (currentPage === totalPages) nextBtn.classList.add('disabled');
    nextBtn.addEventListener('click', () => {
        if (currentPage < totalPages) {
            displayProxies(proxies, currentPage + 1);
        }
    });
    paginationContainer.appendChild(nextBtn);

    // Update proxy count
    proxyCountInfo.textContent = `Showing ${proxies.length} proxies.`;
}

// Fallback proxy list
function displayFallbackProxyList() {
    const fallbackData = `
        vless://00000000-0000-0000-0000-000000000000@1.1.1.1:443?security=tls&encryption=none&headerType=none&type=ws&sni=v.vles.tech&path=%2Fvless#Indonesia+-+Telkomsel
        trojan://00000000-0000-0000-0000-000000000000@2.2.2.2:443?security=tls&headerType=none&type=ws&sni=v.vles.tech&path=%2Ftrojan#Indonesia+-+XL
        ss://YWVzLTEyOC1nY206c2hhcmV5b3VycGFzc3dvcmQ=@3.3.3.3:80?plugin=obfs-local%3Bobfs%3Dhttp%3Bobfs-host%3Dwww.google.com%23Indonesia+-+Indosat
    `.trim();
    processProxyData(fallbackData);
}

// Function to filter proxies based on search query
function filterProxies(query) {
    if (query === '') {
        filteredProxyList = [...proxyList];
    } else {
        filteredProxyList = proxyList.filter(proxy =>
            proxy.provider.toLowerCase().includes(query) ||
            proxy.country.toLowerCase().includes(query) ||
            proxy.ip.toLowerCase().includes(query) ||
            proxy.domain.toLowerCase().includes(query)
        );
    }
}

// Function to select a proxy and show the account creation form
function selectProxy(proxy) {
    selectedProxy = proxy;
    
    // Fill the selected proxy card
    document.getElementById('selected-provider').textContent = proxy.provider;
    document.getElementById('selected-country').textContent = proxy.country;
    document.getElementById('selected-ip').textContent = proxy.ip;
    document.getElementById('selected-port').textContent = proxy.port;
    
    // Show account creation section
    showAccountCreationSection();

    // Reset forms and hide unused protocol forms
    document.querySelectorAll('.protocol-form').forEach(form => {
        form.classList.add('hidden');
    });
    
    // Set active tab to the selected protocol
    document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-target') === `${proxy.protocol}-form`) {
            tab.classList.add('active');
        }
    });
    
    // Show the form for the selected protocol
    const formElement = document.getElementById(`${proxy.protocol}-form`);
    if (formElement) {
        formElement.classList.remove('hidden');

        // Fill the form fields with proxy data
        const nameInput = document.getElementById(`${proxy.protocol}-name`);
        const uuidInput = document.getElementById(`${proxy.protocol}-uuid`);
        const passwordInput = document.getElementById(`${proxy.protocol}-password`);
        const pathInput = document.getElementById(`${proxy.protocol}-path`);
        const securitySelect = document.getElementById(`${proxy.protocol}-security`);
        const serverDomainSelect = document.getElementById(`${proxy.protocol}-server-domain`);
        const bugInput = document.getElementById(`${proxy.protocol}-bug`);
        
        // Populate form fields
        if (nameInput) nameInput.value = `${proxy.provider} (${proxy.country})`;
        if (uuidInput) uuidInput.value = defaultUUID;
        if (passwordInput) passwordInput.value = defaultUUID;
        if (pathInput) pathInput.value = proxy.path || '/';
        
        if (securitySelect) {
            securitySelect.value = proxy.security || 'tls';
        }
        
        if (serverDomainSelect) {
            // Clear existing options
            serverDomainSelect.innerHTML = '';
            // Add options from global serverDomains and the selected proxy's domain
            const allDomains = [...new Set([...serverDomains, proxy.domain])];
            allDomains.forEach(domain => {
                const option = document.createElement('option');
                option.value = domain;
                option.textContent = domain;
                serverDomainSelect.appendChild(option);
            });
            // Set the selected domain
            serverDomainSelect.value = proxy.domain;
        }

        if (bugInput) {
            bugInput.value = proxy.bug === 'N/A' ? '' : proxy.bug;
        }

        // Show wildcard option if a bug is specified
        const wildcardContainer = document.getElementById(`${proxy.protocol}-wildcard-container`);
        if (wildcardContainer) {
            if (bugInput.value !== '' && proxy.bug !== 'N/A') {
                wildcardContainer.classList.add('show');
            } else {
                wildcardContainer.classList.remove('show');
            }
        }
    }
}

// Function to create and show the connection details
function createAccount(protocol) {
    if (!selectedProxy) return;

    let connectionUrl = '';
    const name = document.getElementById(`${protocol}-name`).value;
    const uuid = document.getElementById(`${protocol}-uuid`)?.value || 'N/A';
    const password = document.getElementById(`${protocol}-password`)?.value || 'N/A';
    const path = document.getElementById(`${protocol}-path`).value;
    const security = document.getElementById(`${protocol}-security`).value;
    const serverDomain = document.getElementById(`${protocol}-server-domain`).value;
    const bug = document.getElementById(`${protocol}-bug`).value;

    const encodedBug = bug ? encodeURIComponent(bug) : '';
    const encodedDomain = encodeURIComponent(serverDomain);
    const encodedPath = encodeURIComponent(path);
    const provider = selectedProxy.provider;
    const country = selectedProxy.country;

    const commonParams = `security=${security}&type=ws&sni=${serverDomain}&path=${encodedPath}`;
    
    switch (protocol) {
        case 'vless':
            const vlessEncryption = document.getElementById('vless-encryption').value;
            connectionUrl = `vless://${uuid}@${selectedProxy.ip}:${selectedProxy.port}?encryption=${vlessEncryption}&${commonParams}&host=${encodedDomain}&bug=${encodedBug}#${name.replace(/ /g, '+')}`;
            break;
        case 'trojan':
            connectionUrl = `trojan://${password}@${selectedProxy.ip}:${selectedProxy.port}?${commonParams}&host=${encodedDomain}&bug=${encodedBug}#${name.replace(/ /g, '+')}`;
            break;
        case 'ss':
            const base64Password = btoa(`aes-128-gcm:${password}`);
            const plugin = `plugin=obfs-local;obfs=http;obfs-host=${encodedDomain}`;
            connectionUrl = `ss://${base64Password}@${selectedProxy.ip}:${selectedProxy.port}?${plugin}#${name.replace(/ /g, '+')}`;
            break;
        default:
            console.error('Unknown protocol');
            return;
    }

    document.getElementById('connection-url').textContent = connectionUrl;
    generateQRCode(connectionUrl);
    showResultSection();
}

// Function to generate and display QR code
function generateQRCode(url) {
    const qrcodeContainer = document.getElementById('qrcode');
    qrcodeContainer.innerHTML = '';
    
    QRCode.toCanvas(url, { errorCorrectionLevel: 'H', width: 200, margin: 1 }, function (err, canvas) {
        if (err) throw err;
        qrcodeContainer.appendChild(canvas);
    });
}

// Function to download the QR code
function downloadQrCode() {
    const canvas = document.querySelector('#qrcode canvas');
    if (canvas) {
        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/png');
        link.download = `kuy_share_qr.png`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
}

// Function to copy the connection URL to clipboard
function copyToClipboard() {
    const urlText = document.getElementById('connection-url').textContent;
    navigator.clipboard.writeText(urlText).then(() => {
        alert('URL copied to clipboard!');
    }).catch(err => {
        console.error('Failed to copy text: ', err);
    });
}

// Function to show proxy list section
function showProxyListSection() {
    proxyListSection.classList.remove('hidden');
    accountCreationSection.classList.add('hidden');
    resultSection.classList.add('hidden');
}

// Function to show account creation section
function showAccountCreationSection() {
    proxyListSection.classList.add('hidden');
    accountCreationSection.classList.remove('hidden');
    resultSection.classList.add('hidden');
}

// Helper functions
function generateUUID(elementId) {
    document.getElementById(elementId).value = defaultUUID;
}

function generatePassword(elementId) {
    // Set password to the default UUID instead of generating a random one
    document.getElementById(elementId).value = defaultUUID;
}
</script>
</body>
</html>
